using Plots

res_constant = [-6.736222287565002, -6.946251487924075, -7.1502360212410725, -7.239636179088207, -7.376081106429227, -7.560097616994158, -7.5938126378241995, -7.558264957737545, -7.654694049565778, -7.644540702536429, -7.6608147658716925, -7.736058488148318, -7.773925864912327, -7.739040287794567, -7.713508205705773, -7.598584351329562, -7.670350523808123, -7.761646378104521, -7.706685391037974, -7.734619246956491, -7.731507730266701, -7.703885674352728, -7.746632839389755, -7.803128264583722,
-7.82794935394958, -7.703816697486088, -7.820592418185845, -7.798777997612235, -7.778173216100382, -7.864164420926041]

res_exponential =[-7.076391821650861, -7.470642560596642, -7.759293391911894, -7.967085021736392, -8.120624863082575, -8.20865038357227, -8.229917705561027, -8.33110811452846, -8.333216173741619, -8.381845640134843, -8.332455936728415, -8.369055615998784, -8.28218344225641, -8.372288234901902, -8.299745034946632, -8.34240087635694, -8.328014431840877, -8.418205037247041, -8.278051625636781, -8.276887856980068, -8.44596493414133, -8.327516688493846, -8.29286762050687, -8.296367898942524,
-8.327050156571099, -8.306914499361643, -8.274517767668447, -8.202278119948783, -8.325374227134407, -8.258991943281558]

res_uniform = [-6.541645171605671, -7.0280183656860205, -7.352755191902589, -7.583777056508457, -7.708490749761602, -7.888085157054743, -7.9408033667220765, -7.986588972399815, -8.001887417173343, -8.11642321659505, -8.099627452283865, -8.096303787376012, -8.185938641164306, -8.248887711507312, -8.13612968733216, -8.20187457045764, -8.15997225251754, -8.17238612957639, -8.162595075898743, -8.135355881438079, -8.140781261668703, -8.194756594652903, -8.154920472181255, -8.090593311569442,
-8.177995997104768, -8.114432386439619, -8.09675372618041, -8.146410556744, -8.155242292867037, -8.181860591957134]

res_constant_tau =[-0.7222623279726921, -0.7574593986382012, -0.7481217070616428, -0.7345166311922938, -0.7621419054873876, -0.7894483617848586, -0.794154181366793, -0.7992545122718017, -0.7885605968393169, -0.8007737155191932, -0.7966022366641642, -0.8007523861563939, -0.8071333656244255, -0.8086912766284222, -0.8011707981830153, -0.8066357007227419, -0.786909575500293, -0.7853213435961185, -0.7902909971438069, -0.7940686829049045, -0.787233238817163, -0.7927876712936333, -0.8221631036565009,
-0.8206365743412813, -0.8130940722214988, -0.7971109825893741, -0.8277960048996615, -0.835645507625175, -0.8163999153081039, -0.837343973507199]

res_exponential_tau = [-0.7890765217622087, -0.8294729663458245, -0.8717356802166492, -0.9395425132557501, -0.9568365153287479, -1.0074959294128116, -1.0105321424393148, -1.0299933129388488, -1.0413673286513634, -1.046454116371099, -1.0487072383582046, -1.0545679476802927, -1.0470565628821522, -1.0627178923080505, -1.044086235419793, -1.053038163598359, -1.0530998251408292, -1.059376062021517, -1.0502166113755014, -1.0382131851625045, -1.045945063891109, -1.055179594004708, -1.0406269335577936, -1.0441311461544043, -1.0279086481174489, -1.0455519937417754, -1.023840059972695, -1.0094768372266836, -1.0388914281476072, -1.0305265479711492]

res_uniform_tau =[-0.7391836092592802, -0.7701533577132413, -0.7922779525442419, -0.8331385144935635, -0.8115448335547203, -0.8697759970044175, -0.8828526025618226, -0.89158894289909, -0.9016725534062223, -0.9156861666729305, -0.9459875234017354, -0.936264310128797, -0.9606923787837219, -0.9482349161235075, -0.9581947516335035, -0.9640210415668278, -0.9611147198237053, -0.9664017844295952, -0.9896018558090777, -0.9767812787766669, -0.9667310037349343, -0.9730943059362019, -0.9653795952974069,
-0.9591085706257658, -0.971820208221035, -0.9540693148485255, -0.9637447359415158, -0.9719767117303851, -0.9655007739724182, -0.9396007336840685]

plot(LinRange(0.05,1,30),-res_constant_tau)
plot(LinRange(0.05,1,30),-res_exponential_tau)
plot(LinRange(0.05,2,30),-res_uniform_tau)

plot(LinRange(0.05,1,30),-res_constant)
plot(LinRange(0.05,1,30),-res_exponential)
plot(LinRange(0.05,2,30),-res_uniform)

LinRange(0.05,1,30)[argmin(res_constant_tau)]
LinRange(0.05,1,30)[argmin(res_exponential_tau)]
LinRange(0.05,2,30)[argmin(res_uniform_tau)]

LinRange(0.05,1,30)[argmin(res_constant)]
LinRange(0.05,1,30)[argmin(res_exponential)]
LinRange(0.05,2,30)[argmin(res_uniform)]

default(palette = palette(:default))
p1 = plot(LinRange(0.05,1,30),-res_exponential,
xlabel="\$\\tau \\textrm{[s]}\$",linewidth = 2,label=false,yticks=[7.5,8.0])
annotate!( 0.7, 7.5, text("Exponential", :left, 10))
vline!([0.25],linewidth = 2,label=false)
annotate!( 0.8,  14.5, text("Constant", :left, 10))
p2 = plot(LinRange(0.05,2,30),-res_uniform,
xlabel="\$x^{max} \\textrm{[s]}\$",ylabel="\$\\Delta \\textrm{ Entropy [bit]}\$",linewidth = 2,label=false,yticks=[7.0,8.0])
vline!([0.25],linewidth = 2,label=false)
annotate!( 1.6,  7.5, text("Uniform", :left, 10))
p3 = plot(LinRange(0.05,1,30),-res_constant,
xlabel="\$x_t \\textrm{[s]}\$",linewidth = 2,label=false,yticks=[7.0,7.5])
vline!([0.25],linewidth = 2,label=false)
display(plot(p3, p2, p1, layout = (3, 1), size = (400, 300), dpi=300))
savefig("optimal_joint.png")
